# ADR-007: REST API для внешних клиентов, gRPC для внутренних сервисов

## Статус
Принято

## Контекст
Необходимо выбрать протоколы для взаимодействия:
- Между клиентами (mobile/web) и API Gateway.
- Между микросервисами внутри системы.

## Рассмотренные альтернативы
1. **Только REST (HTTP/1.1, JSON)**.
2. **Только GraphQL**.
3. **Только gRPC**.
4. **Гибрид: REST для внешних, gRPC для внутренних**.

## Решение
- Для внешних клиентов (mobile/web) — REST над HTTP/1.1 или HTTP/2, с JSON и OpenAPI документацией.
- Для внутренних сервисов — использовать gRPC для высоконагруженных взаимодействий, REST для остальных.

### Обоснование
- **REST** — стандарт для публичных API, широкая поддержка в мобильных и веб-клиентах, простота кэширования, лёгкость отладки.
- **gRPC** — высокая производительность, бинарный протокол, строгая типизация, поддержка потоковой передачи, удобен для service-to-service.
- GraphQL отвергнут на старте из-за сложности кэширования и риска сложных запросов, но может быть добавлен позже для специфических сценариев.

## Последствия
### Положительные
- Внешние API просты и понятны.
- Внутренние вызовы быстрые и типизированные.
- Возможность постепенного внедрения gRPC.

### Отрицательные / Требующие внимания
- Поддержка двух протоколов увеличивает сложность.
- Необходимость трансляции между REST и gRPC в некоторых сценариях.
- Требуется генерация клиентов для gRPC.
# ADR-005: Выделенный сервис для интеграций (Integration Service)

## Статус
Принято

## Контекст
Система должна интегрироваться с большим количеством внешних систем:
- Носимые устройства (Garmin, Polar, Apple Watch) через разные протоколы (BLE, ANT+, облачные API).
- Фитнес-платформы (HealthKit, Google Fit).
- Существующие приложения компании (e-commerce, специализированные спортивные приложения).
- Партнёрские системы (новостные агентства, спортивные клубы).

Каждая интеграция требует специфической логики, обработки ошибок, трансформации данных.

## Рассмотренные альтернативы
1. **Прямые вызовы из сервисов** — каждый сервис сам интегрируется с внешними системами.
2. **Выделенный сервис-адаптер (Integration Service)** — единый сервис, инкапсулирующий все внешние взаимодействия.

## Решение
Создать отдельный Integration Service, который предоставляет внутренним сервисам унифицированный API для работы с внешними системами.

### Обоснование
- **Снижение связанности** — изменения во внешних API затрагивают только Integration Service.
- **Повторное использование** — одна и та же интеграция (например, с Garmin) может использоваться разными сервисами.
- **Централизованная обработка ошибок и мониторинг**.
- **Упрощение внутренних сервисов** — они не должны знать детали протоколов.
- **Возможность кэширования и оптимизации запросов** к внешним системам.

## Последствия
### Положительные
- Чистая архитектура с чёткими границами.
- Упрощение тестирования (можно мокировать внешние системы).
- Легче добавлять новые интеграции.

### Отрицательные / Требующие внимания
- Дополнительный hop во внутренних вызовах.
- Риск единой точки отказа (требуется высокое качество реализации и отказоустойчивость).
- Integration Service может стать узким местом (требуется масштабирование).
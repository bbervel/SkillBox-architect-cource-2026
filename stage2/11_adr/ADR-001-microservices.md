# ADR-001: Выбор микросервисной архитектуры

## Статус
Принято

## Контекст
Необходимо спроектировать систему для глобального спортивного приложения с миллионами пользователей. Компания имеет распределённые команды разработчиков, работающие с разными технологиями. Система должна быть масштабируемой, позволять независимо разрабатывать и развёртывать различные функциональные области (пользователи, тренировки, социальные функции, геймификация, промо и т.д.). Существует опыт использования как монолитных, так и микросервисных решений в компании.

## Рассмотренные альтернативы
1. **Монолитная архитектура** — единое приложение, содержащее всю функциональность.
2. **Микросервисная архитектура** — разделение на независимые сервисы по границам предметных областей.
3. **Serverless (FaaS)** — реализация через облачные функции.

## Решение
Выбрана микросервисная архитектура с декомпозицией по бизнес-возможностям (Domain-Driven Design).

### Обоснование
- **Масштабируемость** — возможность независимо масштабировать наиболее нагруженные сервисы (например, Workout Service во время массовых забегов).
- **Независимость команд** — распределённые команды могут владеть и развивать отдельные сервисы без блокировок.
- **Технологическая гибкость** — каждый сервис может использовать наиболее подходящий стек (например, Python для аналитики, Go для высоконагруженных сервисов).
- **Устойчивость к сбоям** — изоляция отказов (падение Social Service не влияет на запись тренировок).
- **Соответствует культуре компании** — компания уже использует микросервисы в других проектах.

Монолит отвергнут из-за сложности масштабирования и координации команд. Serverless отвергнут как основной стиль из-за ограничений по времени выполнения и холодного старта, но может применяться точечно.

## Последствия
### Положительные
- Возможность параллельной разработки.
- Гибкость в выборе технологий.
- Проще тестировать и развёртывать отдельные компоненты.

### Отрицательные / Требующие внимания
- Усложнение сетевого взаимодействия (service-to-service communication).
- Необходимость реализации паттернов распределённых транзакций (Saga).
- Требуется инфраструктура для оркестрации (Kubernetes) и наблюдаемости.
- Дополнительные задержки при межсервисных вызовах.

### Компромиссы
Принято решение мириться с дополнительной сложностью распределённых систем в обмен на масштабируемость и независимость разработки.
# 16. Стоимость владения системой (TCO) в рублях

*Все расчёты выполнены в рублях с использованием курса 77 ₽/$ (принят для пересчёта исходных долларовых цен облачных провайдеров).*

## 16.1. Исходные допущения

| Параметр | Год 1 | Год 2 | Год 5 |
|----------|-------|-------|-------|
| **MAU** (месячная аудитория) | 500 000 | 2 000 000 | 10 000 000 |
| **DAU** (дневная аудитория) | 50 000 | 200 000 | 1 000 000 |
| **Среднее число тренировок в месяц на активного пользователя** | 4 | 5 | 6 |
| **Объём данных одной тренировки** (с треком, метриками) | 500 КБ | 500 КБ | 500 КБ |
| **Ежемесячный прирост данных тренировок** | 500 000 × 4 × 0.5 МБ = 1 ТБ | 2 млн × 5 × 0.5 МБ = 5 ТБ | 10 млн × 6 × 0.5 МБ = 30 ТБ |
| **Количество фотографий/медиа на пользователя в месяц** | 0.1 | 0.2 | 0.5 |
| **Средний размер медиафайла** | 2 МБ | 2 МБ | 2 МБ |
| **Объём медиа в месяц** | 500 000 × 0.1 × 2 МБ = 100 ГБ | 2 млн × 0.2 × 2 МБ = 800 ГБ | 10 млн × 0.5 × 2 МБ = 10 ТБ |
| **Объём логов и событий на пользователя в день** | 10 КБ | 10 КБ | 10 КБ |
| **Объём логов в день** | 50 000 × 10 КБ = 500 МБ | 200 000 × 10 КБ = 2 ГБ | 1 млн × 10 КБ = 10 ГБ |

## 16.2. Модель ценообразования (в рублях)

### 16.2.1. Вычислительные ресурсы (Kubernetes)
- **Стоимость CPU:** 3,08 ₽ за vCPU в час
- **Стоимость RAM:** 0,385 ₽ за ГБ в час

### 16.2.2. Базы данных (управляемые) – стоимость в месяц
- **PostgreSQL:** 23 100 ₽
- **TimescaleDB:** 26 950 ₽
- **MongoDB Atlas:** 30 800 ₽
- **Neo4j Aura:** 38 500 ₽
- **Redis ElastiCache:** 15 400 ₽
- **ClickHouse (self-managed на K8s):** 15 400 ₽ (стоимость виртуальной машины)
- **Объектное хранилище:** 1,77 ₽ за ГБ в месяц

### 16.2.3. Сетевой трафик и CDN
- **Исходящий трафик (внешний):** 6,93 ₽ за ГБ
- **CDN (CloudFront/Cloudflare):** 6,55 ₽ за ГБ
- **Входящий трафик:** обычно бесплатный или 1,54 ₽ за ГБ (для простоты не учитываем)

### 16.2.4. Kafka (управляемая)
- Ориентировочная стоимость: 38 500 ₽/мес (Год 1), 115 500 ₽/мес (Год 2), 385 000 ₽/мес (Год 5)

### 16.2.5. Мониторинг и логирование
- **Логи:** 38,5 ₽ за ГБ

### 16.2.6. Разработка и поддержка (зарплаты)
- **Средняя зарплата инженера:** 462 000 ₽ в месяц (включая налоги и накладные расходы)

### 16.2.7. Резервное копирование
- Хранение копий по цене объектного хранилища: 1,77 ₽ за ГБ

## 16.3. Расчёт затрат по годам (в рублях)

### 16.3.1. Инфраструктура (ежемесячные затраты)

| Статья | Год 1 | Год 2 | Год 5 |
|--------|-------|-------|-------|
| **Вычисления (Kubernetes pods)** | | | |
| – Среднее количество реплик | 30 | 60 | 150 |
| – vCPU | 60 × 730 × 3,08 = 134 904 ₽ | 120 × 730 × 3,08 = 269 808 ₽ | 300 × 730 × 3,08 = 674 520 ₽ |
| – RAM | 120 × 730 × 0,385 = 33 726 ₽ | 240 × 730 × 0,385 = 67 452 ₽ | 600 × 730 × 0,385 = 168 630 ₽ |
| *Итого вычисления* | **168 630 ₽** | **337 260 ₽** | **843 150 ₽** |
| **Базы данных** | | | |
| – PostgreSQL (2,4,10 шт) | 2 × 23 100 = 46 200 ₽ | 4 × 23 100 = 92 400 ₽ | 10 × 23 100 = 231 000 ₽ |
| – TimescaleDB (2,4,10) | 2 × 26 950 = 53 900 ₽ | 4 × 26 950 = 107 800 ₽ | 10 × 26 950 = 269 500 ₽ |
| – MongoDB Atlas (2,4,10) | 2 × 30 800 = 61 600 ₽ | 4 × 30 800 = 123 200 ₽ | 10 × 30 800 = 308 000 ₽ |
| – Neo4j Aura (1,1,1) | 38 500 ₽ | 38 500 ₽ | 38 500 ₽ |
| – Redis (2,4,10) | 2 × 15 400 = 30 800 ₽ | 4 × 15 400 = 61 600 ₽ | 10 × 15 400 = 154 000 ₽ |
| – ClickHouse (на K8s) | 15 400 ₽ | 30 800 ₽ | 77 000 ₽ |
| *Итого БД* | **246 400 ₽** | **454 300 ₽** | **1 078 000 ₽** |
| **Объектное хранилище** | | | |
| – Хранение тренировок (среднемес.) | 6 ТБ × 1024 × 1,77 = 10 875 ₽ | 36 ТБ × 1024 × 1,77 = 65 250 ₽ | 165 ТБ × 1024 × 1,77 = 299 000 ₽ |
| – Хранение медиа (среднемес.) | 0,6 ТБ × 1024 × 1,77 = 1 088 ₽ | 4,8 ТБ × 1024 × 1,77 = 8 700 ₽ | 60 ТБ × 1024 × 1,77 = 108 700 ₽ |
| – Операции (PUT/GET) | 3 850 ₽ | 15 400 ₽ | 77 000 ₽ |
| *Итого объектное хранилище* | **15 813 ₽** | **89 350 ₽** | **484 700 ₽** |
| **CDN (исходящий трафик)** | 1 ТБ/мес = 1024 × 6,55 = 6 707 ₽ | 5 ТБ × 1024 × 6,55 = 33 536 ₽ | 30 ТБ × 1024 × 6,55 = 201 216 ₽ |
| **Kafka (управляемая)** | 38 500 ₽ | 115 500 ₽ | 385 000 ₽ |
| **Мониторинг и логи** | | | |
| – Логи | 15 ГБ × 38,5 = 578 ₽ | 60 ГБ × 38,5 = 2 310 ₽ | 300 ГБ × 38,5 = 11 550 ₽ |
| – Метрики и трейсы | 3 850 ₽ | 7 700 ₽ | 23 100 ₽ |
| *Итого мониторинг* | **4 428 ₽** | **10 010 ₽** | **34 650 ₽** |
| **Резервное копирование** | 2 × (6+0,6) ТБ × 1024 × 1,77 = 23 930 ₽ | 2×(36+4,8) ТБ × 1024 × 1,77 = 148 000 ₽ | 2×(165+60) ТБ × 1024 × 1,77 = 816 000 ₽ |
| **Сетевой трафик (API)** | 150 ГБ/мес × 6,93 = 1 040 ₽ | 600 ГБ/мес × 6,93 = 4 158 ₽ | 3 ТБ/мес × 1024 × 6,93 = 21 300 ₽ |
| **Итого инфраструктура в месяц** | **505 448 ₽** | **1 192 114 ₽** | **3 864 016 ₽** |
| **× 12 месяцев в год** | **6 065 376 ₽** | **14 305 368 ₽** | **46 368 192 ₽** |

### 16.3.2. Разработка и поддержка (затраты на персонал)

| Год | Количество сотрудников | Среднемесячная зарплата | Годовые затраты |
|-----|------------------------|-------------------------|-----------------|
| 1 | 15 | 462 000 ₽ | 15 × 462 000 × 12 = **83 160 000 ₽** |
| 2 | 10 | 462 000 ₽ | 10 × 462 000 × 12 = **55 440 000 ₽** |
| 5 | 5 | 462 000 ₽ | 5 × 462 000 × 12 = **27 720 000 ₽** |

### 16.3.3. Итоговая стоимость владения (TCO) по годам

| Категория | Год 1 | Год 2 | Год 5 |
|-----------|-------|-------|-------|
| Инфраструктура (облако) | 6 065 376 ₽ | 14 305 368 ₽ | 46 368 192 ₽ |
| Разработка и поддержка | 83 160 000 ₽ | 55 440 000 ₽ | 27 720 000 ₽ |
| **ИТОГО** | **89 225 376 ₽** | **69 745 368 ₽** | **74 088 192 ₽** |

*Округлённо:*
- **Год 1:** ~89,2 млн ₽
- **Год 2:** ~69,7 млн ₽
- **Год 5:** ~74,1 млн ₽

## 16.4. Пояснения и допущения

- Все расчёты выполнены с учётом роста пользователей и объёмов данных.
- В инфраструктуру включены: вычислительные ресурсы Kubernetes, управляемые базы данных, объектное хранилище, CDN, Kafka, мониторинг, резервное копирование и сетевой трафик.
- Затраты на разработку включают полный штат команды (разработчики, DevOps, QA, PM) с учётом средней зарплаты 462 000 ₽/мес.
- Не учтены возможные скидки за резервирование ресурсов, затраты на лицензии проприетарного ПО, а также дополнительные расходы (обучение, командировки), которые могут добавить 10–15%.

## 16.5. Анализ чувствительности

Основные факторы, влияющие на стоимость:
- **Рост числа пользователей** – при более быстром росте затраты на инфраструктуру увеличатся пропорционально.
- **Объём данных тренировок** – увеличение частоты загрузки фотографий и видео приведёт к росту затрат на хранение и CDN.
- **Выбор managed-сервисов** – использование self-managed решений может снизить затраты, но повысит сложность эксплуатации.
- **Курс валют** – при изменении курса рубля к доллару затраты на облачные сервисы (выраженные в валюте) будут корректироваться.

## 16.6. Вывод

Стоимость владения системой составляет около 89 млн ₽ в первый год (активная разработка) и снижается до 70–75 млн ₽ в последующие годы, когда основные инвестиции в разработку завершены. Данный бюджет является приемлемым для крупной компании с ожидаемой пользовательской базой в миллионы человек и потенциалом роста продаж через приложение. Рекомендуется регулярно пересматривать прогноз и оптимизировать затраты.